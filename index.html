
<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="utf-8" />
  <title>Status 4+1 â€“ Europese Hoofdsteden</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <style>
    #map { height: 95vh; width: 100%; }
    body { margin: 0; font-family: Arial, sans-serif; }
    h2, h4 { text-align: center; margin: 10px; }
  </style>
</head>
<body>
  <h2>Status 4+1 â€“ Europese Hoofdsteden</h2>
  <h4>Hoofdsteden per 1999 (referentie)</h4>
  <div id="map"></div>

  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script>
    var map = L.map('map').setView([54, 15], 4);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; OpenStreetMap contributors'
    }).addTo(map);

    // Landen arcering via europe.geojson + visited uit map_data.json
    Promise.all([
      fetch('europe.geojson').then(r => r.json()),
      fetch('map_data.json').then(r => r.json())
    ]).then(([geo, data]) => {
        // Landen arcering
        L.geoJSON(geo, {
          style: function(feature) {
            var land = feature.properties.NAME;
            if (data.visited[land] === true) {
              return { fillColor: "green", color: "black", weight: 1, fillOpacity: 0.3 };
            } else if (data.visited[land] === false) {
              return { fillColor: "red", color: "black", weight: 1, fillOpacity: 0.3 };
            } else {
              return { fillColor: "gray", color: "black", weight: 1, fillOpacity: 0.2 };
            }
          },
          onEachFeature: function (feature, layer) {
            layer.bindTooltip("Land: " + feature.properties.NAME);
          }
        }).addTo(map);

        // Markers
        data.markers.forEach(m => {
          var kleur = m.bezocht ? "green" : "red";
          var popup = "<b>" + m.stad + ", " + m.land + "</b><br>"
                    + "Bezocht: " + (m.bezocht ? "Ja" : "Nee") + "<br>";
          if (m.foto) popup += "<img src='" + m.foto + "' width='200'><br>";
          if (m.beschrijving) popup += "<i>" + m.beschrijving + "</i><br>";
          if (m.gdrive) popup += "<a href='" + m.gdrive + "' target='_blank'>ðŸ“‚ Google Drive map</a>";
          L.circleMarker([m.lat, m.lon], { color: kleur }).bindPopup(popup).addTo(map);
        });

        // Routes
        var overlays = {};
        var colors = ["blue", "purple", "orange", "darkred", "darkgreen"];
        var i = 0;
        for (var route in data.routes) {
          var polyline = L.polyline(data.routes[route], {
            color: colors[i % colors.length],
            weight: 4
          });
          overlays[route] = polyline;
          polyline.addTo(map);
          i++;
        }

        // Checkboxen voor routes
        L.control.layers(null, overlays, { collapsed: false }).addTo(map);
    });
  </script>
</body>
</html>
